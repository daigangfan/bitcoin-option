\chapter{套利策略}

\section{套利策略}\label{strategy}
    B-S模型是基于用股票和无风险债券复制期权而没有套利空间的原理推导出来的。由此可以利用实际价格与模型价格偏离的部分，构建套利策略，这一策略将反映出B-S模型中包含的信息价值。根据已有的B-S模型计算delta值后，策略详情如下：
    \begin{itemize}
        \item 对于一只期权，有交易记录的一天即用实际价格和B-S模型价格比较，实际价格高于模型价格的，卖出期权，同时买入delta份比特币进行对冲；实际价格低于模型价格的，买入期权，同时卖出delta份比特币进行对冲。记录现金流。
        \item 在第二天\footnote{当期权的交易数据不是连续时，选择该期权下一条有交易的日期，一般间隔不会太大。}清空已有的持仓（包括期权和股票），同时重新构建新的资产组合。如果第二天为该期权的行权日，则视比特币价格与行权价之间的关系选择是否行权。完成后记录现金流。
        \item 将一只期权各个时点上（构建期权和清空仓位的日期）的现金流按照模型采用的无风险收益率（年化5$\%$）折现至起始日期，并计算入现金流-出现金流。
    \end{itemize}
    除了行权日期之外，这一策略每次建仓至平仓的收益可以表示为：
    \begin{equation}
        \Delta{P}-\delta{\Delta{S}}-(P-\delta{S})r\Delta{t}
    \end{equation}
    其中，P为期权建仓时价格，$\Delta{P}$为前后期权价格变化，$\Delta{S}$为前后比特币价格变化，r为无风险利率。
    根据参考文献\cite{Hull-2017}，考虑到价格和波动率之间的相关性，可以通过修正由B-S模型简单计算出来的delta的方式来实现优化的对冲比率。推导得到的最优对冲比率$\delta_{MV}$\footnote{此处的最优指的是期望的最小方差}为：
    \begin{equation}\label{MVmodel}
        \delta_{MV}=\delta_{BS}+\frac{\gamma_{BS}}{S\sqrt{T}}(a+b\delta_{BS}+c\delta^2_{BS})
    \end{equation}
    其中$\delta_{BS}$为Black-Scholes模型计算出的delta，$\gamma_{BS}$为Black-Scholes模型计算出的gamma。
    实际应用中，可以滚动估计包含delta和delta二次项的线性模型：
    \begin{equation}\label{MVreg}
        \Delta{f}-\delta_{BS}\Delta{S}=\frac{\gamma_{BS}}{\sqrt{T}}\frac{\Delta{S}}{S}(\hat{a}+\hat{b}\delta_{BS}+\hat{c}\delta^2_{BS})+\epsilon
    \end{equation}
    得到参数之后带入式\ref{MVmodel}，可得到此时的对冲误差为：
    \begin{equation}
        \epsilon_{MV}=\Delta{f}-\delta_{BS}\Delta{f}-\frac{\gamma_{BS}}{\sqrt{T}}\frac{\Delta{f}}{S}(\hat{a}+\hat{b}\delta_{BS}+\hat{c}\delta^2_{BS})
    \end{equation}
    根据最小二乘法的定义，如果原有对冲误差和$\delta_{BS}$之间的关系设定正确，则对冲误差$\epsilon_{MV}$的方差已经被最小化。
    
\section{套利策略结果}
\subsection{基本delta对冲策略}
将第\ref{strategy}节构建的策略应用到筛选后的数据上。一个普通的delta套利策略结果如下所示（分call和put描述）： 
~\\ 
\begin{table}[H]
    \caption{套利组合收益描述分析}
    \centering
    \input{new_describes/call_return_describe.tex}
    \input{new_describes/put_return_describe.tex}
\end{table}

~\\
对于认购期权，盈利金额均值大于0。对收益率序列做t检验，可得t值为3.40，对应的P-value在0.001以下，整体收益显著为正。同时胜率（收益中>0的比例）可以达到70$\%$，但仍然存在亏损比较严重的部分数据。
对于认沽期权，盈利金额均值大于0。对收益率序列做t检验，可得t值为0.44，收益并不显著大于0。胜率为50$\%$，同时不论是亏损还是盈利均存在较大的极端值，并不稳定。说明认沽期权的真实价格与模型价格之间的差异是更加持续性的，模型对于认沽期权价格的确定包含的信息很少，相比之下，对认购期权而言，模型包含了一定的信息价值。部分期权利用模型包含的delta信息能够获得较高收益。这进一步证明了认购期权本身的偏低定价可能来自于其对于比特币收益等因素的敏感。由于整体市场比特币收益为对称结构，这导致我们在整个时间上回测策略可以充分利用认购期权定价的有效性。
\par{上述策略采用了逐天构建组合套利的模式。对于我们研究的流动性不佳的期权可能难以实现，我们可以考虑只需要买入、卖出一个期权，之后逐天用当天的delta份股票去对冲直至到期的策略。这样大幅降低了对期权频繁买卖的需求。为了充分利用全部数据，我们仍假设每天的每个交易我们都能够参与，买入实际价格低于模型价格的期权、卖出delta份股票或者卖出实际价格高于模型价格的期权、买入delta份股票，并在之后每天都动态调节股票数量，直至到期。结果如下：
}
\begin{table}[H]
    \caption{动态对冲模式套利组合收益描述分析}
    \centering
    \input{new_describes/call_continuous_return_describe.tex}
\input{new_describes/put_continuous_return_describe.tex}
\end{table}
所得结果与之前类似，所有认购期权结果的均值大于0，t值为5.4，显著大于0，但对认沽而言其收益的t值为1.96，而且胜率低于50$\%$。其结论与之前逐天构建资产的策略相比可能更加稳定。
\subsection{修正delta后的策略}
根据前述模型式\ref{MVmodel}，其考虑了通常股票市场上价格与波动率的负相关性。但比特币数据中，价格与波动率之间呈正相关性（为0.43）。但我们依旧可以利用此模型对对冲偏差和delta之间的关系建模。用全部数据期做回归，得到\ref{MVmodel}中的最优对冲比例后，进行前述逐日对冲策略，得到结果如下：
\begin{table}[H]
    \caption{套利组合收益描述分析}
    \centering
    \input{new_describes/call_opt_return_describe.tex}
    \input{new_describes/put_opt_return_describe.tex}
\end{table}
相比于原始方法，并无显著的提升。我的解释是：这种方法通过考虑价格与波动率的相关性，实际上在追求定价与原始价格上的接近。同时，我根据原文，对式\ref{MVreg}的估计得到的R方极小（约为0.002），说明实际上能够用delta和delta的二次项解释的对冲误差比例很小，这与在股票市场上的情况非常不同，因此这一模型在比特币市场上不具有实际意义。
