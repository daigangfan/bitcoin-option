\chapter{实证结果}
\section{定价结果}
按照第4章的Black-Scholes模型\ref{bs-call}和\ref{bs-put}，对每个期权的每条交易数据，将距离到期期限、数据期的波动率估计（采用滚动估计方式）、利率、当日比特币价格、行权价等信息输入模型，得到Black-Scholes模型定价。期权的真实价格为当天的成交量加权均价。在定价过程中，我们发现部分期权由于深度价外、而且期限较短，几乎没有模型价值，但仍有较高的真实价格，如果用二者数值的绝对差异将无法表现出这种定价差异的真实影响，损失过多的信息，故定义定价偏差为真实价格与模型价格之比即真实价格/模型价格。同时根据参考文献，深度价外期权和期限较短的期权并不适合用B-S模型定价\cite{10.2307/1831029}\cite{Jame-1979}。因此我们对数据做如下清理：
\begin{itemize}
    \item 剔除每日交易量仅有1的记录
    \item 剔除距离到期日在7日之内的记录
    \item 剔除认购期权的相对价值在0.8以下，认沽期权的相对价值在1.25以上的记录
    \item 剔除期权价格不在期权价格合理范围内的记录，这些期权无法按照价格求得隐含波动率。
\end{itemize}
保留共计600条记录。
600条记录的定价偏差的描述性统计以及按认购、认沽期权的分组统计之后结果如下：
~\\
\begin{center}
    \begin{threeparttable}[H]
    
        \begin{small}
            \caption{定价偏差描述统计}
            \label{tab:option_bias_group}
                \input{new_describes/dependent_variables_describe.tex}
                
        \end{small} 
    \end{threeparttable}
\end{center}
可见在合理的相对价值区间内，真实价格和模型价格差异仍然较大，最大接近6倍。最小接近十分之一，平均水平低于1，说明总体真实价格略低于模型价格。分组结果中，认购期权的平均偏差低于1，而认沽期权的平均偏差高于1，说明平均情况下，认购期权通常价格被低估，而认沽期权通常价格被高估。
~\\
为了初步展示定价偏差和期权价值程度之间的关系，我按照期权的相对价值（比特币价格/行权价）和期限分组，统计了各个组内定价偏差的平均值，以下是定价绝对偏差分组统计的结果：
~\\
\begin{center}
    \begin{threeparttable}[H]
        \centering
        \begin{small}
            \caption{定价偏差分组统计}
            \label{tab:option_bias_group}
                \input{new_describes/_option_bias_group.tex}
                \begin{tablenotes}
                    \footnotesize
                    \item 注：money\_cut指期权价值程度分组边界（比特币价格/行权价），time\_cut指距到期期限分组边界。
                    
                \end{tablenotes}
        \end{small}
    \end{threeparttable}
        
\end{center}
~\\
可以看到，定价偏差随期限的上升呈增长趋势。对认购和认沽期权分别分组统计，结果如下：
~\\
\begin{center}
    \begin{threeparttable}[H]
        \begin{small}
            \caption{定价偏差分组统计:认购期权}
            \label{tab:call_option_bias_group}
                \input{new_describes/call_option_bias_group.tex}
        \end{small}
    \end{threeparttable}
        
\end{center}
~\\
认沽期权分组统计结果：
~\\
\begin{center}
    \begin{threeparttable}[H]
        \begin{small}
            \caption{定价偏差分组统计:认沽期权}
            \label{tab:put_option_bias_group}
                \input{new_describes/put_option_bias_group.tex}
    
        \end{small}
    \end{threeparttable}
        
\end{center}
~\\
从分组结果直观而言，对认沽期权实值期权的偏差要小于虚值期权，而对于认购期权这一现象并不明显。
\section{隐含波动率}
隐含波动率即使得Black-Scholes模型价格等于真实价格的波动率参数，这一数值表示了隐含于期权市场价格中与波动率有关的信息。以期权相对价值（S/K）将全部期权分为五组，并求各组平均隐含波动率，以各组相对价值中位数为横轴，隐含波动率为纵轴绘制折线图如下：
\begin{figure}[H]
    \begin{small}
        \begin{center}
            \includegraphics[width=0.95\textwidth]{figures/mean_isd.png}
        \end{center}
        \caption{隐含波动率分组曲线}
        \label{fig:mean_isd}
    \end{small}
\end{figure}
图像呈现出一定的“波动率微笑”性质，相对价值接近1的时候隐含波动率水平更低。本质上隐含波动率微笑现象反映了收益分布与对数正态分布之间的差异。为此我们可以构建两个在回归模型中需要用到的变量。
\par{
    波动率溢价：定义为从现在至期权到期日期间比特币波动率与期权隐含波动率之差。由于波动率越大，一般期权的价格越高，这一指标衡量了期权交易者对波动率的预测与未来期权波动率符合程度。
}

\section{回归模型}
我们首先构建第\ref{reg vars}节提出的变量，并对其进行描述性统计。变量的描述统计和相关性矩阵如下:
\newpage
\newgeometry{top=1cm,bottom=1cm
}
\begin{landscape} 
    \begin{table}[H]
        \caption{解释变量的描述性统计}
        \resizebox{\linewidth}{!}{
        \input{new_describes/independent_variables_describe.tex}
        }
    \end{table}
    \begin{table}[H]
        \caption{解释变量的相关性矩阵}
        \resizebox{\linewidth}{!}{\input{new_describes/independent_variables_corr.tex}    }
    \end{table}    
\end{landscape}

    \newpage
\restoregeometry
其中，log\_ret为当日比特币对数收益率、volatility为30天滚动估计收益波动率、skewness为30天滚动估计收益偏度、amihud为Amihud非流动性指标，maxmin\_ratio为交易所价格最大者与最小者之比，btc\_volume为当日比特币交易量，time为期权期限，delta\_5为当前模型下计算出的delta，
vol\_pre为波动率溢价（参见\ref{reg vars}），open\_interest为当日该期权持仓量，contract\_is\_call为指示变量，指期权是否为认购期权。
\par{其中，相对价值（比特币价格/行权价）的意义与期权的种类有关，对于认购期权，这一指标越高证明期权价值程度越深，对于认沽期权则完全相反，故构建两个交互变量inter\_call\_money和inter\_put\_money来表示不同类期权中的相对价值对定价偏差的影响。}
\par{从相关性矩阵可见，部分变量之间的相关性水平较高。可利用后向逐步回归的方法剔除部分变量，即先采用全部变量进行回归，再通过AIC信息熵损失最小法逐步选择去掉的变量并进行回归。最终，结合相关性矩阵并参考后向逐步回归结果，可以剔除掉比特币波动率、偏度、期权种类指示变量和偏度的交互项这几个变量。以偏差为解释变量，进行最小二乘法回归，结果如下：}
\newpage
\newgeometry{top=1cm}
\begin{center}
    \begin{threeparttable}[H]

        \caption{回归估计结果}
        \input{new_describes/regression_table.tex}
        
        \begin{tablenotes}
            \footnotesize
            \item *:p值<0.1, **:p值<0.05, ***:p值<0.001
            \item 括号中汇报估计系数的标准差。
        \end{tablenotes}
    \end{threeparttable}
\end{center}
\newpage
\restoregeometry
\par{
实际上，这里的定价差异相当于是假设B-S模型价格为供需平衡状态下的均衡价格，而偏差主要衡量了期权的供需不均衡的程度。这些解释变量都能起到解释期权供需差异的意义。峰度为比特币的收益分布与对数正态分布不符的衡量，其系数显著为正，证明了过高的尾部风险会推高期权的价格。比特币的交易量衡量了短期市场的热度，当市场投资情绪较高时，对对冲的要求也更高，故此时对期权的需求更大，提升了期权的价格。衡量比特币交易流动性的Amihud指标、最大价格与最小价格之比两个变量均与比特币市场的流动性有负相关关系，而在回归结果中对期权定价的相对偏差有显著正向关系。说明很可能随着比特币市场流动性下降，投资者对于用期权进行风险管理和投机交易的需求也在不断提升，另一方面，流动性的变差导致B-S模型推导过程中用到的delta-对冲模式不能完整实现，故而导致价格不能回到有效情况下的水准。
}
\par{对于和期权自身性质有关的变量，其中比较显著的影响是波动率溢价。波动率溢价变量本身用到了未来信息，但它能够证明，部分价格看上去过高的期权交易可以被认为是投资者获得了对于未来波动率会更高的信息，投资者自身对未来波动率的预测是影响期权供需的重要因素。除此之外，在控制其他变量不变的情况下，看涨期权价格会相对偏离更高，时间较长的反而导致真实价格相对偏低，与之前分组统计结果不符。一个可能的解释是看涨期权更容易受到其他变量的影响，导致其综合影响为期权的总体价格偏低。对于期权价值程度的交互变量而言，对于两种期权都是实值程度越深，定价偏差越小，这也符合股票市场上观察到的结果。期权的持仓量对整个模型几乎无影响，说明期权的流动性可能对价格偏差的影响不大\footnote{此处受数据限制，缺乏更有效的变量证明}。整个模型的R方达到50$\%$以上，有一定的解释能力。}
\par{为了识别除了价值程度之外，其他变量是否在不同种类的期权中有不同的作用，同时是否有一些变量拉低了看涨期权的实际价格，将两种期权分组之后分别做最小二乘法回归，结果如下：}
\newpage
\newgeometry{top=3cm}
\begin{center}
    \begin{threeparttable}[H]

        \caption{回归估计结果}

        \input{new_describes/seperate_regression_table.tex}
        \begin{tablenotes}
            \footnotesize
            \item *:p值<0.1, **:p值<0.05, ***:p值<0.001
            \item 括号中汇报估计系数的标准差。
        \end{tablenotes}
    \end{threeparttable}
\end{center}
\newpage
\restoregeometry
将认购期权和认沽期权分别回归后，可以发现很多变量对于两者有着不同的效应。比特币收益率对看涨期权有显著的负向影响，是一部分看涨期权总体被模型价格高估的原因，其解释是在比特币市场收益较高情况下，投资者可能更畏惧下行风险，故而对认沽期权的需求更大。对期限的解释同理，过长的期限可能受到波动率不确定性、非流动性的影响可能更大。两种期权受到其他变量影响的方向基本一致。
\section{套利策略}
\subsection{基本delta对冲策略}
将第\ref{strategy}节构建的策略应用到筛选后的数据上。一个普通的delta套利策略结果如下所示（分call和put描述）： 
~\\ 
\begin{table}
    \caption{套利组合收益描述分析}
    \centering
    \input{new_describes/call_return_describe.tex}
    \input{new_describes/put_return_describe.tex}
\end{table}

~\\ 
对于认购期权，盈利金额均值大于0。对收益率序列做t检验，可得t值为3.40，对应的P-value在0.001以下，整体收益显著为正。同时胜率（收益中>0的比例）可以达到70$\%$，但仍然存在亏损比较严重的部分数据。
对于认沽期权，盈利金额均值大于0。对收益率序列做t检验，可得t值为0.44，收益并不显著大于0。胜率为50$\%$，同时不论是亏损还是盈利均存在较大的极端值，并不稳定。说明认沽期权的真实价格与模型价格之间的差异是更加持续性的，模型对于认沽期权价格的确定包含的信息很少，相比之下，对认购期权而言，模型包含了一定的信息价值。部分期权利用模型包含的delta信息能够获得较高收益。这进一步证明了认购期权本身的偏低定价可能来自于其对于比特币收益等因素的敏感。由于整体市场比特币收益为对称结构，这导致我们在整个时间上回测策略可以充分利用认购期权定价的有效性。
\par{上述策略采用了逐天构建组合套利的模式。对于我们研究的流动性不佳的期权可能难以实现，我们可以考虑只需要买入、卖出一个期权，之后逐天用当天的delta份股票去对冲直至到期的策略。这样大幅降低了对期权频繁买卖的需求。为了充分利用全部数据，我们仍假设每天的每个交易我们都能够参与，买入实际价格低于模型价格的期权、卖出delta份股票或者卖出实际价格高于模型价格的期权、买入delta份股票，并在之后每天都动态调节股票数量，直至到期。结果如下：
}
\begin{table}[H]
    \caption{动态对冲模式套利组合收益描述分析}
    \centering
    \input{new_describes/call_continuous_return_describe.tex}
\input{new_describes/put_continuous_return_describe.tex}
\end{table}
所得结果与之前类似，所有认购期权结果的均值大于0，t值为5.4，显著大于0，但对认沽而言其收益的t值为1.96，而且胜率低于50$\%$。其结论与之前逐天构建资产的策略相比可能更加稳定且更具实际意义。
\subsection{修正delta后的策略}
根据前述模型式\ref{MVmodel}，其考虑了通常股票市场上价格与波动率的负相关性。但比特币数据中，价格与波动率之间呈正相关性（为0.43）。但我们依旧可以利用此模型对对冲偏差和delta之间的关系建模。用全部数据期做回归，得到\ref{MVmodel}中的最优对冲比例后，进行前述逐日对冲策略，得到结果如下：
\begin{table}[H]
    \caption{套利组合收益描述分析}
    \centering
    \input{new_describes/call_opt_return_describe.tex}
    \input{new_describes/put_opt_return_describe.tex}
\end{table}
相比于原始方法，并无显著的提升。我的解释是：这种方法一定程度上在追求定价与原始价格上的接近。同时，我根据原文，对式\ref{MVreg}的估计得到的R方极小（约为0.002），说明实际上能够用delta和delta的二次项解释的对冲误差比例很小，因此这一模型在比特币市场上不具有实际意义。